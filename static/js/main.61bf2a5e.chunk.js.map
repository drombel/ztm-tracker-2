{"version":3,"sources":["reducers/marker/markerReducer.js","reducers/buses/busesReducer.js","reducers/routes/routesReducer.js","utils/api.js","components/map/map.js","reducers/settings/settingsReducer.js","views/homepage/SettingsPopup.js","views/homepage/FiltersPopup.js","views/homepage/BusesPopup.js","views/homepage/homepage.js","reducers/store.js","App.js","reportWebVitals.js","index.js"],"names":["markerSlice","createSlice","name","initialState","reducers","setMarker","state","action","payload","resetMarker","actions","busesSlice","setBuses","Array","isArray","length","routesSlice","setRoutes","API","getRoutes","type","url","getBuses","Marker","text","onClick","Fab","color","style","transform","Typography","variant","Map","busesFetch","useFetch","routesFetch","buses","useSelector","store","routes","marker","settings","timeout","useRef","dispatch","useDispatch","loadBuses","options","refresh","data","get","Date","getTime","then","res","Vehicles","filter","item","GPSQuality","popup","VehicleId","freshMarker","find","popupData","Delay","time","Math","abs","toISOString","substr","cond","title","value","Route","route","tripId","parseInt","routeId","Line","tripHeadsign","VehicleCode","Speed","current","Fragment","DialogTitle","sx","textAlign","DialogContent","TableContainer","component","Paper","Table","TableBody","Object","entries","map","key","TableRow","TableCell","scope","align","DialogActions","Button","useEffect","clearInterval","setInterval","apiIsLoaded","date","split","trips","loadRoutes","filteredBuses","filters","speed","includes","delay","line","route_stop","label","top","bottom","left","right","position","bootstrapURLKeys","process","defaultZoom","defaultCenter","lat","lng","zoom","center","yesIWantToUseGoogleMapApiInternals","onGoogleApiLoaded","Lat","Lon","Dialog","onClose","open","setRefresh","setFilters","extra","hasOwnProperty","max","min","isNaN","resetFilters","setOptions","resetOptions","props","popupState","setPopupState","handleClose","FormControl","fullWidth","marginBottom","FormGroup","FormControlLabel","control","Switch","checked","preparedBuses","Set","sort","preparedRoutes","i","unique","findIndex","t","a","b","localeCompare","id","Stack","spacing","marginTop","minHeight","TextField","onChange","e","target","InputProps","inputProps","Autocomplete","disablePortal","multiple","width","renderInput","params","useState","setLine","bus","newBus","undefined","numeric","formattedText","trim","replace","re","RegExp","test","height","maxHeight","InputLabel","htmlFor","Input","maxWidth","endAdornment","IconButton","Clear","setBus","cursor","hover","Homepage","drawerState","setDrawerState","settingsState","setSettingsState","filtersState","setFiltersState","busesState","setBusesState","toggleDrawer","event","Box","display","flexDirection","flexGrow","AppBar","Toolbar","size","edge","mr","Menu","Drawer","anchor","role","onKeyDown","List","ListItem","button","ListItemIcon","ListItemText","primary","Settings","Filter","flex","SettingsPopup","FiltersPopup","BusesPopup","configureStore","reducer","markerReducer","busesReducer","routesReducer","settingsReducer","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.61bf2a5e.chunk.js","sourcesContent":["import { createSlice } from '@reduxjs/toolkit'\r\n\r\nexport const markerSlice = createSlice({\r\n  name: 'marker',\r\n  initialState: null,\r\n  reducers: {\r\n    setMarker: (state, action) => {\r\n      return action.payload;\r\n    },\r\n    resetMarker: (state) => {\r\n      return null;\r\n    },\r\n  }\r\n})\r\n\r\nexport const { setMarker, resetMarker } = markerSlice.actions\r\n\r\nexport default markerSlice.reducer","import { createSlice } from '@reduxjs/toolkit'\r\n\r\nexport const busesSlice = createSlice({\r\n  name: 'buses',\r\n  initialState: [],\r\n  reducers: {\r\n    setBuses: (state, action) => {\r\n      if (Array.isArray(action.payload) && action.payload.length > 0)\r\n        return action.payload;\r\n    },\r\n  }\r\n})\r\n\r\nexport const { setBuses } = busesSlice.actions\r\n\r\nexport default busesSlice.reducer","import { createSlice } from '@reduxjs/toolkit'\r\n\r\nexport const routesSlice = createSlice({\r\n  name: 'routes',\r\n  initialState: [],\r\n  reducers: {\r\n    setRoutes: (state, action) => {\r\n      if (Array.isArray(action.payload) && action.payload.length > 0)\r\n        return action.payload;\r\n    },\r\n  }\r\n})\r\n\r\nexport const { setRoutes } = routesSlice.actions\r\n\r\nexport default routesSlice.reducer","const API = {\r\n  getRoutes: {\r\n    type: 'GET',\r\n    url: 'https://ckan.multimediagdansk.pl/dataset/c24aa637-3619-4dc2-a171-a23eec8f2172/resource/b15bb11c-7e06-4685-964e-3db7775f912f/download/trips.json'\r\n  },\r\n  getBuses: {\r\n    type: 'GET',\r\n    url: 'https://ckan2.multimediagdansk.pl/gpsPositions'\r\n  },\r\n};\r\n\r\nexport default API;","// import { Wrapper, Status } from \"@googlemaps/react-wrapper\";\r\nimport React, { useEffect, useRef } from 'react';\r\nimport { Typography, Dialog, DialogTitle, TableContainer, Table, Paper, TableRow, TableCell, TableBody, Button, DialogContent, DialogActions, Fab } from '@mui/material';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { setMarker, resetMarker } from '../../reducers/marker/markerReducer';\r\nimport { setBuses } from '../../reducers/buses/busesReducer';\r\nimport { setRoutes } from '../../reducers/routes/routesReducer';\r\nimport API from '../../utils/api';\r\nimport useFetch from 'use-http';\r\nimport './map.css';\r\nimport GoogleMapReact from 'google-map-react';\r\n\r\nconst Marker = ({ text = '', onClick = () => null }) => {\r\n  return (\r\n    <Fab color=\"primary\" onClick={onClick} style={{ transform: 'translate(-50%, -50%)' }}>\r\n      <Typography variant=\"body1\">{text}</Typography>\r\n    </Fab>\r\n  );\r\n};\r\n\r\nfunction Map (){\r\n  const busesFetch = useFetch(API.getBuses.url); // { get, response, loading, error }\r\n  const routesFetch = useFetch(API.getRoutes.url); // { get, response, loading, error }\r\n  const buses = useSelector(store => store.buses);\r\n  const routes = useSelector(store => store.routes);\r\n  const marker = useSelector(store => store.marker);\r\n  const settings = useSelector(store => store.settings);\r\n  const timeout = useRef({ buses: null, routes: null, });\r\n  const dispatch = useDispatch();\r\n\r\n  function loadBuses() {\r\n    if (!settings.options.refresh) return;\r\n    let data = [];\r\n    busesFetch\r\n      .get(`?date=${new Date().getTime()}`)\r\n      .then(res => {\r\n        data = Array.isArray(res?.Vehicles) ? res?.Vehicles?.filter(item => item.GPSQuality > 2) : [];\r\n        if (data.length>0) dispatch(setBuses(data));\r\n      })\r\n  }\r\n\r\n  function loadRoutes() {\r\n    let data = [];\r\n    routesFetch\r\n      .get(`?date=${new Date().getTime()}`)\r\n      .then(res => {\r\n        const date = (new Date()).toISOString().split('T')[0];\r\n        data = (!!res[date] && res[date]?.trips && Array.isArray(res[date]?.trips)) ? res[date].trips : [];\r\n        if (data.length>0) dispatch(setRoutes(data));\r\n      })\r\n  }\r\n\r\n\r\n  let popup = useRef(null);\r\n\r\n  if (!!marker?.VehicleId) {\r\n    const freshMarker = buses.find(item => item.VehicleId === marker.VehicleId)\r\n    let popupData = {};\r\n    if (freshMarker?.Delay !== 0){\r\n      const time = new Date(Math.abs(freshMarker.Delay) * 1000).toISOString().substr(11, 8);\r\n      const cond = freshMarker?.Delay > 0;\r\n      popupData['delay'] = { title: 'Czas', value: (<span style={{color: (cond ? '#B00000' : '#00B000')}}>{cond ? 'Opóźniony' : 'Przed czasem'} {time}</span>) };\r\n    }\r\n    if (!!freshMarker?.Route){\r\n      const route = routes.find(route => route.tripId === parseInt(freshMarker.Route) && route.routeId === parseInt(freshMarker.Line));\r\n      if (!!route)\r\n        popupData['route_stop'] = { title: 'Trasa', value: route.tripHeadsign };\r\n    }\r\n    if (!!freshMarker?.VehicleCode){\r\n      popupData['vehicle_code'] = { title: 'Kod pojazdu', value: freshMarker.VehicleCode };\r\n    }\r\n    if (!!freshMarker?.Speed){\r\n      popupData['speed'] = { title: 'Prędkość', value: `${freshMarker.Speed} km/h` };\r\n    }\r\n\r\n    popup.current = (\r\n      <React.Fragment>\r\n        <DialogTitle sx={{ textAlign: 'center' }}>{freshMarker.Line}</DialogTitle>\r\n        <DialogContent>\r\n          <TableContainer component={Paper}>\r\n            <Table aria-label=\"Dane autobusu\">\r\n              <TableBody>\r\n                {Object.entries(popupData).map(([key, item]) => (\r\n                  <TableRow key={key}>\r\n                    <TableCell component=\"th\" scope=\"row\">{item.title}</TableCell>\r\n                    <TableCell align=\"right\">{item.value}</TableCell>\r\n                  </TableRow>\r\n                ))}\r\n              </TableBody>\r\n            </Table>\r\n          </TableContainer>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => dispatch(resetMarker())}>Zamknij</Button>\r\n        </DialogActions>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (buses?.length === 0) loadBuses();\r\n    clearInterval(timeout.current.buses)\r\n    timeout.current.buses = setInterval(() => {\r\n      loadBuses()\r\n    }, 5000);\r\n  }, [settings])\r\n\r\n  const apiIsLoaded = () => {\r\n    loadRoutes();\r\n  };\r\n  \r\n  const handleMarkerClick = data => () => {\r\n    dispatch(setMarker(data))\r\n  };\r\n\r\n  let filteredBuses = buses;\r\n  // todo: pogrupować to do wspólnej zmiennej\r\n  if (settings.filters.speed !== 0 || !['', '-'].includes(settings.filters.delay) || settings.filters.line.length > 0 || settings.filters.route_stop.length > 0) {\r\n    filteredBuses = filteredBuses.filter(item => {\r\n      let cond = true;\r\n      cond &= settings.filters.speed !== 0 ? item.Speed >= settings.filters.speed : cond;\r\n      cond &= !['', '-'].includes(settings.filters.delay) ? (item.Delay || 0) <= (settings.filters.delay*-1) : cond;\r\n      cond &= settings.filters.line.length > 0 ? !!settings.filters.line.find(line => line.label == item.Line) : cond;\r\n      cond &= settings.filters.route_stop.length > 0 ? !!settings.filters.route_stop.find(route => route.tripId === parseInt(item.Route) && route.routeId === parseInt(item.Line)) : cond;\r\n      return cond;\r\n    });\r\n  }\r\n  // TODO: dopisać do autocomplete przy route te dane tripId, routeId żeby można było odfiltrować dane, następnie odfiltrować, dodanie zaczytywania lokalizacji z tel,\r\n  // wrzucić temu pajacowi i poprawić co się tu tylko da, oczyścić z nieużywanych paczek i warningów oraz opisać użyte paczki\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div style={{ top: 0, bottom: 0, left: 0, right: 0, position: 'absolute' }}>\r\n        <GoogleMapReact\r\n          bootstrapURLKeys={{ key: process.env.REACT_APP_GOOGLE_MAPS_KEY }}\r\n          defaultZoom={15}\r\n          defaultCenter={{ lat: 54.3622393, lng: 18.5750017 }}\r\n          zoom={settings.options.zoom}\r\n          center={settings.options.center}\r\n          yesIWantToUseGoogleMapApiInternals\r\n          onGoogleApiLoaded={() => apiIsLoaded()}\r\n        >\r\n          {filteredBuses.map((item) => (item.Lat && item.Lon) ? <Marker key={item.VehicleId} data={item} lat={item.Lat} lng={item.Lon} text={item.Line} onClick={handleMarkerClick(item)} /> : null)}\r\n        </GoogleMapReact>\r\n      </div>\r\n      <Dialog onClose={() => {dispatch(resetMarker())}} open={!!marker && !!popup.current}>\r\n        {popup.current}\r\n      </Dialog>\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nexport default Map;","import { createSlice } from '@reduxjs/toolkit'\r\n\r\nconst initialState = {\r\n  filters: {\r\n    speed: 0,\r\n    delay: '',\r\n    route_stop: [],\r\n    line: [],\r\n  },\r\n  options: {\r\n    refresh: true,\r\n    center: { lat: 54.3622393, lng: 18.5750017 },\r\n    zoom: 15,\r\n  }\r\n};\r\n\r\nexport const markerSlice = createSlice({\r\n  name: 'settings',\r\n  initialState: initialState,\r\n  reducers: {\r\n    setRefresh: (state, action) => {\r\n      state.options.refresh = !!action.payload;\r\n    },\r\n    setFilters: (state, action) => {\r\n      let extra = {};\r\n      \r\n      if (action.payload.hasOwnProperty('speed'))      extra['speed'] = Math.max(Math.min(parseInt(action.payload.speed) || 0, 200), 0);\r\n      if (action.payload.hasOwnProperty('delay'))      extra['delay'] = !isNaN(parseInt(action.payload.delay)) ? (parseInt(action.payload.delay) || 0) : (action.payload.delay === '-' ? '-' : '');\r\n      if (action.payload.hasOwnProperty('route_stop')) extra['route_stop'] = Array.isArray(action.payload.route_stop) ? action.payload.route_stop : initialState.filters.route_stop;\r\n      if (action.payload.hasOwnProperty('line'))       extra['line'] = Array.isArray(action.payload.line) ? action.payload?.line : initialState.filters.line;\r\n      state.filters = { ...state.filters, ...extra };\r\n    },\r\n    resetFilters: (state) => {\r\n      state.filters = initialState.filters;\r\n    },\r\n    setOptions: (state, action) => {\r\n      state.options = {\r\n        ...state.options,\r\n        center: action.payload?.center ? action.payload?.center : state.center,\r\n        zoom: action.payload?.center ? 17 : state.zoom,\r\n      };\r\n    },\r\n    resetOptions: (state) => {\r\n      state.filters = initialState.options;\r\n    },\r\n  }\r\n})\r\n\r\nexport const { setRefresh, setFilters, resetFilters, setOptions, resetOptions, } = markerSlice.actions\r\n\r\nexport default markerSlice.reducer","import { useSelector, useDispatch } from 'react-redux';\r\nimport { setRefresh, resetOptions } from '../../reducers/settings/settingsReducer';\r\n\r\nimport { DialogTitle, Dialog, DialogActions, DialogContent, Button, FormControl, FormGroup, FormControlLabel, Switch, } from '@mui/material';\r\n\r\nexport default function (props) {\r\n  const { popupState = false, setPopupState = () => null } = props;\r\n  const settings = useSelector(store => store.settings);\r\n  const dispatch = useDispatch();\r\n  const handleRefreshToggle = () => {\r\n    dispatch(setRefresh(!settings.options.refresh));\r\n  }\r\n  const handleResetSettings = () => {\r\n    dispatch(resetOptions());\r\n  };\r\n\r\n  const handleClose = () => setPopupState(false);\r\n\r\n  return (\r\n    <Dialog onClose={handleClose} open={!!popupState}>\r\n      <DialogTitle sx={{ textAlign: 'center' }}>Ustawienia</DialogTitle>\r\n      <DialogContent>\r\n      <FormControl variant=\"standard\" fullWidth sx={{ marginBottom: 20 }}>\r\n          <FormGroup>\r\n            <FormControlLabel control={<Switch checked={settings.options.refresh} onClick={handleRefreshToggle} />} label=\"Odświeżanie w tle\" />\r\n          </FormGroup>\r\n        </FormControl>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={handleResetSettings}>Resetuj</Button>\r\n        <Button onClick={handleClose}>Zamknij</Button>\r\n      </DialogActions> \r\n    </Dialog>\r\n  );\r\n}","import { DialogTitle, Dialog, DialogActions, DialogContent, Button, TextField, FormControl, Stack, InputLabel, Select, MenuItem, Autocomplete } from '@mui/material';\r\nimport { setFilters, resetFilters } from '../../reducers/settings/settingsReducer';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { Box } from '@mui/system';\r\n\r\nexport default function (props) {\r\n  const { popupState = false, setPopupState = () => null } = props;\r\n  const filters = useSelector(store => store.settings.filters);\r\n  const buses = useSelector(store => store.buses);\r\n  const routes = useSelector(store => store.routes);\r\n  const dispatch = useDispatch();\r\n\r\n  // todo: zmienić preparedBuses jak są prepared routes\r\n  const preparedBuses = [...new Set(buses.filter(item => !!item.Line).map(item => item.Line))].sort().map(item => ({ label: item }));\r\n  const preparedRoutes = routes\r\n    .filter((item, i, unique) => (!!item.tripHeadsign && i === unique.findIndex((t) => (t.tripHeadsign === item.tripHeadsign))))\r\n    .sort((a, b) => a.tripHeadsign.localeCompare(b.tripHeadsign))\r\n    .map(item => ({ label: item.tripHeadsign, id: item.id, key: item.id, routeId: item.routeId, tripId: item.tripId }));\r\n  \r\n  // todo: add delay to avoid flooding redux with requests\r\n  const handleClose = () => setPopupState(false);\r\n  const handleReset = () => dispatch(resetFilters());\r\n  const handleSpeed = e => dispatch(setFilters({ speed: e.target.value }));\r\n  const handleDelay = e => dispatch(setFilters({ delay: e.target.value }));\r\n  const handleRouteStop = (e, value) => dispatch(setFilters({ route_stop: value }));\r\n  const handleLine = (e, value) => dispatch(setFilters({ line: value }));\r\n\r\n  return (\r\n    <Dialog onClose={handleClose} open={!!popupState}>\r\n      <DialogTitle sx={{ textAlign: 'center' }}>Filtry nałożone na mapę</DialogTitle>\r\n      <DialogContent>\r\n        <Stack spacing={3} sx={{marginTop: 10, minHeight: 400}}>\r\n          <FormControl variant=\"standard\" fullWidth>\r\n            <TextField label=\"Prędkość\" type=\"number\" onChange={handleSpeed} value={filters.speed} InputProps={{ inputProps: { min: 0, max: 200 } }} />\r\n          </FormControl>\r\n          <FormControl variant=\"standard\" fullWidth>\r\n            <TextField label=\"Przyśpieszenie składu w sekundach\" type=\"text\" onChange={handleDelay} value={filters.delay} />\r\n          </FormControl>\r\n          <FormControl fullWidth>\r\n            <Autocomplete\r\n              disablePortal value={filters.route_stop} multiple\r\n              options={preparedRoutes} onChange={handleRouteStop}\r\n              sx={{ width: 300 }} \r\n              renderInput={(params) => <TextField {...params} label=\"Przystanek docelowy\" />}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth>\r\n            <Autocomplete\r\n              disablePortal value={filters.line} multiple\r\n              options={preparedBuses} onChange={handleLine}\r\n              sx={{ width: 300 }} \r\n              renderInput={(params) => <TextField {...params} label=\"Linia\" />}\r\n            />\r\n          </FormControl>\r\n        </Stack>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={handleReset}>Resetuj</Button>\r\n        <Button onClick={handleClose}>Zamknij</Button>\r\n      </DialogActions> \r\n    </Dialog>\r\n  );\r\n}","import { useSelector, useDispatch } from 'react-redux';\r\nimport { setMarker } from '../../reducers/marker/markerReducer';\r\nimport { setOptions } from '../../reducers/settings/settingsReducer';\r\nimport { useRef, useState } from 'react';\r\n\r\nimport { DialogTitle, Dialog, DialogActions, DialogContent, Button,  Paper, TableContainer, Table, TableRow, TableCell, TableBody, FormControl, InputLabel, Input, IconButton, } from '@mui/material';\r\nimport { Clear as ClearIcon } from '@mui/icons-material';\r\n\r\nexport default function (props) {\r\n  const { popupState = false, setPopupState = () => null } = props;\r\n  const [line, setLine] = useState('');\r\n  const buses = useSelector(store => store.buses);\r\n  const routes = useSelector(store => store.routes);\r\n  const preparedBuses = useRef([]);\r\n  const dispatch = useDispatch();\r\n  const handleClose = () => setPopupState(false);\r\n\r\n  preparedBuses.current = buses.map(bus => {\r\n    let newBus = {...bus};\r\n    const route = routes.find(route => route.tripId === parseInt(bus.Route) && route.routeId === parseInt(bus.Line));\r\n    newBus['tripHeadsign'] = route?.tripHeadsign || 'Brak docelowego przystanku';\r\n    return newBus;\r\n  })\r\n  .sort((a, b) => a.Line.localeCompare(b.Line, undefined, {numeric: true}));\r\n\r\n  const formattedText = (line || '(.)*').trim().replace(' ', ').*(');\r\n  const re = new RegExp(`.*(${formattedText})+.*`,\"gi\");\r\n  const filteredBuses = (!!line ? preparedBuses.current.filter(item => re.test(item.Line) || re.test(item.tripHeadsign) ) : preparedBuses.current);\r\n\r\n  const setBus = (item) => {\r\n    dispatch(setOptions({center: { lat: item.Lat, lng: item.Lon }}));\r\n    dispatch(setMarker(item));\r\n    setPopupState(false);\r\n  };\r\n\r\n  return (\r\n    <Dialog onClose={handleClose} open={!!popupState}>\r\n      <DialogTitle sx={{ textAlign: 'center' }}>Autobusy i tramwaje</DialogTitle>\r\n      <DialogContent sx={{ height: '80vh', maxHeight: 600, }}>\r\n        <FormControl variant=\"standard\" fullWidth style={{ marginBottom: 20 }}>\r\n          <InputLabel htmlFor=\"component-simple\">Linia lub trasa</InputLabel>\r\n          <Input value={line} onChange={e => setLine(e.target.value)} \r\n            sx={{ width: 500, maxWidth: '100%', }}\r\n            endAdornment={<IconButton onClick={() => setLine('')}><ClearIcon /></IconButton>}\r\n          />\r\n        </FormControl>\r\n        <TableContainer component={Paper}>\r\n          <Table aria-label=\"Lista autobusów\">\r\n            <TableBody>\r\n              {filteredBuses.map((item) => (\r\n                <TableRow key={item.VehicleId} onClick={() => setBus(item)} sx={{cursor: 'pointer'}} hover>\r\n                  <TableCell>{item.tripHeadsign}</TableCell>\r\n                  <TableCell align=\"right\">{item.Line}</TableCell>\r\n                </TableRow>\r\n              ))}\r\n            </TableBody>\r\n          </Table>\r\n        </TableContainer>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={handleClose}>Zamknij</Button>\r\n      </DialogActions> \r\n    </Dialog>\r\n  );\r\n}","import React, { useState } from 'react';\r\nimport './homepage.css';\r\nimport Map from './../../components/map/map';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport SettingsPopup from './SettingsPopup';\r\nimport FiltersPopup from './FiltersPopup';\r\nimport BusesPopup from './BusesPopup';\r\n\r\nimport { DialogTitle, Dialog, Drawer, List, DialogActions, DialogContent, Button, AppBar, Box, Toolbar, Typography, IconButton, ListItem, ListItemIcon, ListItemText } from '@mui/material';\r\nimport { Menu as MenuIcon, DirectionsBus as BusIcon, Settings as SettingsIcon, Filter as FilterIcon } from '@mui/icons-material';\r\n\r\nfunction Homepage () {\r\n  const [drawerState, setDrawerState] = useState(false);\r\n  const [settingsState, setSettingsState] = useState(false);\r\n  const [filtersState, setFiltersState] = useState(false);\r\n  const [busesState, setBusesState] = useState(false);\r\n\r\n  const toggleDrawer = (open) => (event) => {\r\n    if (event.type === 'keydown' && (event.key === 'Tab' || event.key === 'Shift')) return;\r\n    setDrawerState(open);\r\n  };\r\n\r\n  return (\r\n    <Box sx={{ display: 'flex', flexDirection: 'column', minHeight: '100vh' }}>\r\n      <header>\r\n        <Box sx={{ flexGrow: 1 }}>\r\n          <AppBar position=\"sticky\">\r\n            <Toolbar>\r\n              <IconButton size=\"large\" edge=\"start\" color=\"inherit\" aria-label=\"menu\" sx={{ mr: 2 }} onClick={toggleDrawer(true)}>\r\n                <MenuIcon />\r\n              </IconButton>\r\n              <Typography variant=\"h6\" component=\"div\" sx={{ flexGrow: 1 }}>ZTM tracker 2</Typography>\r\n            </Toolbar>\r\n          </AppBar>\r\n        </Box>\r\n        <Drawer\r\n            anchor='left'\r\n            open={drawerState}\r\n            onClose={toggleDrawer(false)}\r\n          >\r\n          <Box\r\n            sx={{ width: 250 }} role=\"presentation\"\r\n            onClick={toggleDrawer(false)}\r\n            onKeyDown={toggleDrawer(false)}\r\n          >\r\n            <List>\r\n              <ListItem button onClick={() => setBusesState(true)}><ListItemIcon><BusIcon /></ListItemIcon><ListItemText primary={'Autobusy i tramwaje'} /></ListItem>\r\n              <ListItem button onClick={() => setSettingsState(true)}><ListItemIcon><SettingsIcon /></ListItemIcon><ListItemText primary={'Ustawienia'} /></ListItem>\r\n              <ListItem button onClick={() => setFiltersState(true)}><ListItemIcon><FilterIcon /></ListItemIcon><ListItemText primary={'Filtry'} /></ListItem>\r\n            </List>\r\n          </Box>\r\n        </Drawer>\r\n      </header>\r\n      <Box sx={{ flex: '1 0 0', display: 'flex' }}>\r\n        <Map />\r\n      </Box>\r\n\r\n      <SettingsPopup popupState={settingsState} setPopupState={setSettingsState} />\r\n      <FiltersPopup popupState={filtersState} setPopupState={setFiltersState} />\r\n      <BusesPopup popupState={busesState} setPopupState={setBusesState} />\r\n      \r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default Homepage;","import { configureStore } from '@reduxjs/toolkit';\r\nimport markerReducer from './marker/markerReducer';\r\nimport busesReducer from './buses/busesReducer';\r\nimport routesReducer from './routes/routesReducer';\r\nimport settingsReducer from './settings/settingsReducer';\r\n\r\nexport default configureStore({\r\n  reducer: {\r\n    marker: markerReducer,\r\n    buses: busesReducer,\r\n    routes: routesReducer,\r\n    settings: settingsReducer,\r\n  }\r\n})","import React from 'react';\nimport Homepage from './views/homepage/homepage';\nimport './app.css';\nimport store from './reducers/store'\nimport { Provider } from 'react-redux'\n\nfunction App() {\n  return (\n    <Provider store={store}>\n      <Homepage />\n    </Provider>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}